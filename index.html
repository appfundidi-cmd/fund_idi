<!-- index.html -->
<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Portal de Proveedores - Fundación IDI</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />
</head>
<body class="antialiased">

  <!-- ... todo tu HTML original ... -->

  <script>
    // Año actual en footer
    document.getElementById("currentYear").textContent = new Date().getFullYear();

    // --- CORRECCIÓN DE CONEXIÓN GEO DATA ---
    let geoData = {};
    const geoDataPromise = loadGeoData();

    async function loadGeoData() {
      try {
        // Ruta corregida y espera asincrónica adecuada
        const response = await fetch("./geodata.json");
        if (!response.ok) throw new Error(`Error al cargar geodata.json: ${response.status}`);
        geoData = await response.json();
        console.log("geodata.json cargado correctamente:", geoData);
      } catch (error) {
        console.error("Error al cargar geodata.json", error);
        geoData = { departamentos: [] };
      }
      return geoData;
    }

    // Función para inicializar los campos geográficos
    async function setupGeoFields() {
      await geoDataPromise; // Asegura carga previa
      const departamentoSelect = document.getElementById("departamento");
      const ciudadSelect = document.getElementById("ciudad");

      if (!geoData.departamentos) {
        console.error("El formato de geodata.json no es válido. Debe contener 'departamentos'.");
        return;
      }

      departamentoSelect.innerHTML = '<option value="">Seleccione...</option>';
      geoData.departamentos.forEach((d) => {
        const option = document.createElement("option");
        option.value = d.departamento;
        option.textContent = d.departamento;
        departamentoSelect.appendChild(option);
      });

      departamentoSelect.addEventListener("change", () => {
        const selectedDepto = geoData.departamentos.find(
          (dep) => dep.departamento === departamentoSelect.value
        );
        ciudadSelect.innerHTML = '<option value="">Seleccione...</option>';
        if (selectedDepto) {
          selectedDepto.ciudades.forEach((city) => {
            const option = document.createElement("option");
            option.value = city;
            option.textContent = city;
            ciudadSelect.appendChild(option);
          });
        }
      });
    }

    // --- Resto de tu JavaScript original permanece igual ---
  </script>
</body>
</html>
